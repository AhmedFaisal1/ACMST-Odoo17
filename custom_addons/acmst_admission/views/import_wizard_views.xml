<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="view_admissions_import_wizard" model="ir.ui.view">
            <field name="name">admissions.import.wizard.form</field>
            <field name="model">admissions.import.wizard</field>
            <field name="arch" type="xml">
                <form string="Import Candidates">
                    <group>
                        <field name="upload" filename="filename"/>
                        <field name="filename"/>
                        <field name="mapping_json" placeholder='{"BaseID":"base_university_id"}'/>
                        <div class="o_form_label">Expected headers:</div>
                        <p>first_ar, second_ar, third_ar, fourth_ar, first_en, second_en, third_en, fourth_en, program_code, year_code, base_university_id, dob, national_id</p>
                        <field name="preview" nolabel="1" readonly="1" widget="text"/>
                        <group>
                            <field name="imported_count"/>
                            <field name="rejected_count"/>
                        </group>
                    </group>
                    <footer>
                        <button name="action_download_sample" type="object" string="Download Sample CSV" class="btn-secondary"/>
                        <button name="action_preview" type="object" string="Preview" class="btn-secondary"/>
                        <button name="action_import" type="object" string="Import" class="btn-primary"/>
                        <button string="Close" class="btn-link" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <record id="action_admissions_import_wizard" model="ir.actions.act_window">
            <field name="name">Import Candidates</field>
            <field name="res_model">admissions.import.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
            <!-- Bind into the Action menu of Candidates, not a menu item -->
            <field name="binding_model_id" ref="model_admissions_candidate"/>
            <field name="binding_type">action</field>
            <field name="binding_view_types">list</field>
        </record>

        <!-- Explicit menu to open the popup when user clicks it (not first child) -->
        <menuitem id="menu_admissions_import_records" name="Import Records"
                  parent="acmst_admission.menu_admissions_root"
                  action="action_admissions_import_wizard" sequence="8"
                  groups="acmst_admission.group_admissions_admin,acmst_admission.group_admissions_officer,base.group_system"/>
    </data>
</odoo>
